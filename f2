some more changes done to the code by dev2
